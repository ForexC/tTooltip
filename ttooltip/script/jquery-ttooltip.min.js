/*!
 * tTooltip v0.1
 *
 * Copyright 2012 Takien, No Inc
 * http://takien.com
 * 
 * Licensed under the Apache License v2.0
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * follow @cektkp and @perdanaweb
 */
(function(a){function b(b){var c=b.position();var d=c.top-a(window).scrollTop();var e=c.left-a(window).scrollLeft();var f=a(window).width()-(e+b.width());var g=a(window).height()-(d+b.height());var h="topleft";if(d>g){h="bottom"}else{h="top"}if(e>f){h+="right"}else{h+="left"}return h}a.fn.ttooltip=function(c){var d=a.extend({},a.fn.ttooltip.defaultOptions,c);var e=a(d.template);var f=e.find(".ttooltip-content");var g=e.find(".ttooltip-title");var h=e.find(".ttooltip-footer");var i=0;var j=0;e.css({position:"absolute","max-width":d.maxwidth});return this.each(function(c){var k=a(this);k.bind(d.trigger,function(c){function w(a){a.bind(d.close,function(){j++;if(j==1){i=setTimeout(function(){x(e)},d.timeout);e.bind("mouseenter",function(){j=0;clearTimeout(i)})}})}function x(a){a.fadeOut(d.fadeoutspeed,function(){a.remove()});clearTimeout(i);j=0}clearInterval(i);e.appendTo(document.body);e=a(".ttooltip-wrap");f=e.find(".ttooltip-content");g=e.find(".ttooltip-title");h=e.find(".ttooltip-footer");var l=k.attr("data-title");var m=k.attr("data-content");var n=k.attr("data-footer");var p=k.attr("href");var q=k.attr("data-width");if(m==undefined){return false}f.addClass("clearfix");h.addClass("clearfix");e.removeClass().addClass("ttooltip-wrap ttooltip-"+b(k)).fadeIn();var r=e.find(".ttooltip-arrow");var s=c.pageX-(r.outerWidth()*.5+r.position().left);var u=25;var v;s=s-u;if(m=="ajax"){a.get(p,function(a){e.find(".ttooltip-inner").html(a)})}else{g.show().html(l);f.show().html(m);h.show().html(n);if(n==undefined){h.empty().hide()}if(l==undefined){g.empty().hide()}}r.removeClass("tooltip-arrow-gray");v=k.position().top+k.outerHeight()+r.outerHeight();if(b(k)=="bottomright"||b(k)=="bottomleft"){v=k.position().top-e.outerHeight()-r.outerHeight();s=s-u;u=0;if(e.find(".ttooltip-footer").html()!=""){r.addClass("tooltip-arrow-gray")}}e.css({top:v,left:s,width:q,opacity:1}).fadeIn();if(d.followmouse){a(this).mousemove(function(a){e.css({top:v,left:a.pageX-r.position().left-u})})}if(d.autohide){w(a(this));w(e)}if(d.closeonesc){document.onkeydown=function(a){a=a||window.event;if(a.keyCode==27){x(e)}}}c.preventDefault()})})};a.fn.ttooltip.defaultOptions={autohide:true,followmouse:true,closeonesc:true,content:"",title:"",trigger:"mouseenter",close:"mouseleave",maxwidth:500,timeout:2e3,fadeoutspeed:"slow",template:'<div class="ttooltip-wrap"><div class="ttooltip-arrow ttooltip-arrow-border"></div><div class="ttooltip-arrow"></div><div class="ttooltip-inner"><h3 class="ttooltip-title"></h3><div class="ttooltip-content"><p></p></div><div class="ttooltip-footer"></div></div></div>'}})(jQuery)